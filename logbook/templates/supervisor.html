{% extends 'base.html' %}

{% load static %}
{% load filters %}

{% block titleblock %}Guild Volunteering System{% endblock %}

{% block sideblock %}
<div class="col-sm-2 col-md-2 sidebar">

    <h3>Overview</h3>
    <ul class="nav nav-sidebar">
        <li class="active"><a href=".">Approve Hours</a><span class="sr-only">(current)</span></li>
        <li><a href="{% url 'logbook:list' %}#statistics">Statistics</a></li>
    </ul>
</div>
{% endblock %}

{% block bodyblock %}
<div class="col-sm-10 col-sm-offset-2 col-md-10 col-md-offset-2 main">
    <h1 class="page-header">Manage Your Students</h1>
    <div class="panel-group" id="accordion">
        {% if logbooks %}
        {% for logbook in logbooks %}
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>
                        <a href="#{{ logbook.book__id }}" data-toggle="collapse" data-parent="#accordion"><span class="collapse in"><h4>{{ logbook.book__user__user__first_name }} {{ logbook.book__user__user__last_name }} - {{ logbook.book__user__user__username }} <span class = "badge">{{ logbook.entries_pending }}</span> </h4></a>
                </div>

                <div id="{{ logbook.book__id }}" class="panel-collapse collapse">
                    <div class="panel-body">
                        <table class="table table-responsive table-striped">
                            <thead>
                                <tr>
                                    <th>Start Time</th>
                                    <th>End Time</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if entries %}
                                {% for logentry in entries %}
                                    {% if logentry.book.id == logbook.book__id %}
                                    <tr class = "">
                                        <td class="hidden"><input type="checkbox" name="model_selected" value="{{ logentry.id }}"></td>
                                        <td>{{ logentry.start|date:"d/m/y P" }}</td>
                                        <td>{{ logentry.end|date:"d/m/y P" }}</td>
                                        <td>
                                            <div class='btn-toolbar'>
                                                <button class="btn btn-success visible-xs"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button>
                                                <button class="btn btn-danger visible-xs"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
                                                <button class="btn btn-success hidden-xs">Approve</button>
                                                <button class="btn btn-danger hidden-xs">Decline</button>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endif %}
                                {% endfor %}
                                {% endif %}
                            </tbody>
                        </table>
                        <h4>Total of {{ logbook.entries_pending_total_duration|timedelta }} to be approved</h4>
                        <button class="btn btn-success">Approve All</button>
                        <button class="btn btn-lg btn-inverse" onclick="location.href='mailto:{{logbook.book__user__user__username}}@student.uwa.edu.au'"><span class="glyphicon glyphicon-envelope"></span></button>
                    </div>
                </div>
            </div>
        {% endfor %}
        {% endif %}
    </div>
</div>

{% endblock %}
